<!-- pendente: criar campos da própria empresa ao invés de data -->

<div class="container mx-auto max-w-4xl p-4">
    <!-- cabeçalho -->
    <div class="bg-white shadow-xl rounded-2xl p-6 mb-6 border-t-4 border-emerald-600">
      <div class="flex flex-col md:flex-row items-start md:space-x-6">

        <!-- imagem -->
        <div class="relative group inline-block">
            <img [src]="data.fotoPlaceholder" alt="Logo da Empresa"
                class="w-24 h-24 rounded-full object-cover ring-4 ring-white shadow-lg mb-4 md:mb-0 -mt-16" />
            
            <button (click)="abrirJanelaFoto()"
                class="absolute inset-0 flex flex-col items-center justify-center bg-black bg-opacity-40 text-white text-sm font-medium opacity-0 group-hover:opacity-100 rounded-full transition duration-200">
            Editar foto
          </button>
        </div>

        <div class="flex-1">
          <h2 class="text-3xl font-extrabold text-gray-800">{{ data.nomeFantasia }}</h2>
          <p class="text-xl text-emerald-600 font-medium mb-3">{{ data.razaoSocial }}</p>
  
          <div class="text-sm text-gray-600 space-y-1">
            <p class="flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-gray-500" fill="none"
                   viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8m-2 4v7a2 2 0 01-2 2H5a2 2 0 01-2-2v-7"></path>
              </svg>
              {{ data.email }}
            </p>
            <p class="flex items-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 mr-2 text-gray-500" fill="none"
                   viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                      d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.75 21 3 14.25 3 6V5z"></path>
              </svg>
              {{ data.telefone }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- sobre -->
    <div class="bg-white shadow-xl rounded-2xl p-6 mb-6">
        <h3 class="text-2xl font-bold text-gray-700 mb-4 border-b pb-2">Sobre</h3>
        <p class="text-gray-700 leading-relaxed">{{ data.resumo }}</p>
    </div>

    <!-- campanhas -->
    <div class="bg-white shadow-xl rounded-2xl p-6">
        <h3 class="text-2xl font-bold text-gray-700 mb-4 border-b pb-2">Campanhas Recentes</h3>
    
        <app-campanha-janela
          *ngFor="let campanha of data.campanhas | slice:-3"
          [campanha]="campanha"
          (abrir)="abrirDetalhes(campanha)">
        </app-campanha-janela>
    
        <p class="text-emerald-600 mt-4 cursor-pointer hover:underline text-center font-semibold"
           (click)="abrirTodas()">
           Visualizar todas as campanhas
        </p>
      </div>
    </div>

    <!-- pop-up individual -->
    <div *ngIf="campanhaSelecionada" class="fixed inset-0 flex items-center justify-center z-60">
        <div class="absolute inset-0 backdrop-brightness-[0.3] transition duration-300"></div>
        <div class="bg-white rounded-2xl shadow-xl max-w-md w-full p-6 relative">
            <button (click)="fecharPopup()" class="absolute top-2 right-3 text-gray-500 hover:text-gray-800 text-4xl leading-none">&times;</button>
            <h3 class="text-2xl font-bold text-gray-800 mb-3">{{ campanhaSelecionada.titulo }}</h3>
            <p class="text-gray-600 mb-2"><strong>Tipo:</strong> {{ campanhaSelecionada.tipo }}</p>
            <p class="text-gray-600 mb-2"><strong>Ano:</strong> {{ campanhaSelecionada.ano }}</p>
            <p class="text-gray-600 mb-2"><strong>Descrição:</strong> {{ campanhaSelecionada.descricao }}</p>
            <p class="text-gray-700 mt-4">(colocar mais detalhes aqui depois)</p>
        </div>
    </div>
  
    <!-- pop-up de todas as campanhas -->
    <div *ngIf="mostrarTodas" class="fixed inset-0 flex items-center justify-center z-70">
        <div class="absolute inset-0 backdrop-brightness-[0.3] transition duration-300"></div>
        <div class="bg-white rounded-2xl shadow-xl max-w-2xl w-full p-6 relative">
            <button (click)="fecharTodas()" class="absolute top-2 right-3 text-gray-500 hover:text-gray-800 text-4xl leading-none">&times;</button>
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Todas as Campanhas</h3>
            
            <div class="overflow-y-auto max-h-[65vh] pr-2">
                <app-campanha-janela
                *ngFor="let campanha of data.campanhas"
                [campanha]="campanha"
                (abrir)="abrirDetalhes(campanha)">
            </app-campanha-janela>
            </div>
        </div>
    </div>

    <!-- rankings -->
    <div class="flex justify-center z-70">
        <div class="bg-white shadow-2xl rounded-2xl p-6 mb-6">
            <h3 class="text-2xl font-bold text-gray-700 mb-4 border-b pb-2">Estatísticas e Rankings</h3>
            <div class="grid grid-cols-2 gap-6 text-center">
                <div>
                    <p class="text-3xl font-bold text-green-600">{{ data.estatisticas.mutiroes }}</p>
                    <p class="text-gray-600 text-sm">Mutirões realizados</p>
                </div>
                <div>
                    <p class="text-3xl font-bold text-green-600">{{ data.estatisticas.lugares }}</p>
                    <p class="text-gray-600 text-sm">Locais limpos</p>
                </div>
                <div>
                    <p class="text-3xl font-bold text-green-600">{{ data.estatisticas.voluntarios }}</p>
                    <p class="text-gray-600 text-sm">Voluntários</p>
                </div>
                <div>
                    <p class="text-3xl font-bold text-green-600">{{ data.estatisticas.lixo }} kg</p>
                    <p class="text-gray-600 text-sm">Lixo recolhido</p>
                </div>
                <div class="col-span-2">
                    <p class="text-3xl font-bold text-green-600">R$ {{ data.estatisticas.fundos }}</p>
                    <p class="text-gray-600 text-sm">Fundos arrecadados</p>
                </div>
            </div>
            <div class="mt-6 flex justify-center">
                <canvas id="graficoCategorias" class="w-full h-64"></canvas>
            </div>
        </div>
    </div>

    <!-- pop-up para editar foto -->
    <div *ngIf="mostrarJanelaFoto" class="fixed inset-0 flex items-center justify-center z-80">
        <div class="absolute inset-0 backdrop-brightness-[0.3] transition duration-300"></div>
        <div class="bg-white rounded-2xl shadow-xl max-w-md w-full p-6 relative text-center">
        <button (click)="fecharJanelaFoto()" class="absolute top-2 right-3 text-gray-500 hover:text-gray-800 text-4xl leading-none">&times;</button>
        <h3 class="text-2xl font-bold text-gray-800 mb-4">Editar foto de perfil</h3>
        <p class="text-gray-600 mb-4">Selecione uma nova imagem para o perfil da empresa:</p>
    
        <input type="file" accept="image/*"
                (change)="uploadFoto($event)"
                class="block w-full text-sm text-gray-700 border border-gray-300 rounded-lg cursor-pointer focus:outline-none p-2"
        />
        
        <button (click)="removerFoto()" class="bg-red-500 text-white px-2 py-1 rounded-lg hover:bg-red-600 transition mt-4">Remover foto</button>
        
        <div *ngIf="previewFoto" class="mt-4 flex flex-col items-center">
            <img [src]="previewFoto" alt="Prévia da nova foto" class="w-24 h-24 rounded-full object-cover shadow-lg mb-3" />
            <button (click)="salvarNovaFoto(previewFoto)" class="bg-emerald-600 text-white px-4 py-2 rounded-lg hover:bg-emerald-700 transition">Salvar</button>
        </div>
    </div>
</div>
  